<!doctype html>
<html>
<head>
    <meta charset="utf-8" />
    <title>CORS Test</title>
</head>

<body>
<script>
<!--

var texta;
var ipaddr;
var rqst;

function clearText()
{
    texta = document.getElementById("response");
    texta.value = "";
}

function newCORSRequest(method, url)
{
    var xhr = new XMLHttpRequest();
    texta = document.getElementById("response");
    texta.value = "Got new XHR ";

    xhr.onreadystatechange=function() {
        texta.value += "\n" + xhr.readyState + " " + xhr.status + " ";
        texta.value += xhr.statusText + " " + xhr.responseText;
        if (xhr.readyState==4 && xhr.status==200) {
            texta.value += " Yay!";
        }
    }
    if ("withCredentials" in xhr)
    {
        // Check if the XMLHttpRequest object has a "withCredentials" property.
        // "withCredentials" only exists on XMLHTTPRequest2 objects.
        texta.value += "Opened withCredentials";
        xhr.open(method, url, true);
    }
    else if (typeof XDomainRequest != "undefined")
    {
        // Otherwise, check if XDomainRequest.
        // XDomainRequest only exists in IE, and is IE's way of making CORS requests.
        texta.value += "Opened XDomainRequest";
        xhr = new XDomainRequest();
        xhr.open(method, url);
    }
    else
    {
        // Otherwise, CORS is not supported by the browser.
        xhr = null;
        texta.value += "XHR null";
    }
    return xhr;
}


function testOptions()
{
    texta = document.getElementById("response");
    ipaddr= document.getElementById("ipaddr");
    rqst  = document.getElementById("request");

    var method = "OPTIONS";
    var url = "http://"+ipaddr.value;
    rqst.value = url;

    try {
        var xhr = newCORSRequest(method, url);
        if(!xhr) {
            throw new Error('CORS not supported');
        }
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.send();
    }
    catch (err) {
        texta.value += "\nXHR Request Exception "+err;
    }
}

function testRequest()
{
    texta = document.getElementById("response");
    ipaddr= document.getElementById("ipaddr");
    rqst  = document.getElementById("request");

    var method = "XPOST";
    var url = "http://"+ipaddr.value+"/ld";
    rqst.value = url;

    try {
        var xhr = newCORSRequest(method, url);
        if(!xhr) {
            throw new Error('CORS not supported');
        }
        xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xhr.send();
    }
    catch (err) {
        texta.value += "\nXHR Request Exception "+err;
    }
}
-->
</script>
<div>
    <input type="text"   id="ipaddr"  size="16" value="192.168.1.103" />
    <input type="text"   id="request" size="30" value="" />
    <input type="button" id="clr_btn" value="CLEAR" onclick='clearText();' />
    <input type="button" id="optsbtn" value="OPTS"  onclick='testOptions();' />
    <input type="button" id="testbtn" value="TEST"  onclick='testRequest();' />
</div>
<div>
    <textarea id="response" rows="15" cols="70" value="" ></textarea>
    </div>
</body>
</html>
